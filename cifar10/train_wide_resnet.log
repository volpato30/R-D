Using gpu device 0: Tesla K20m (CNMeM is disabled, cuDNN 4007)
Using wide ResNet with depth 3 and width 8.
slurmstepd: *** JOB 36354 CANCELLED AT 2016-07-26T10:33:03 *** on mos3
[[[ 130.75244141  130.17788696  131.09840393 ...,  131.06219482
    130.39842224  130.14701843]
  [ 130.13287354  129.36053467  130.2159729  ...,  130.02433777
    129.31971741  129.13659668]
  [ 129.76211548  128.73402405  129.50337219 ...,  129.19064331
    128.58988953  128.59837341]
  ..., 
  [ 126.57824707  124.61959839  123.95822144 ...,  124.15877533
    124.65871429  125.52228546]
  [ 127.06539917  125.50246429  125.31173706 ...,  125.38726807
    125.5404892   125.96044159]
  [ 127.70964813  126.59329224  126.86144257 ...,  126.73193359
    126.55873108  126.6016922 ]]

 [[ 136.14033508  135.52326965  136.34104919 ...,  136.3011322
    135.70535278  135.45051575]
  [ 135.37062073  134.51811218  135.22067261 ...,  135.09593201
    134.52755737  134.35528564]
  [ 134.72454834  133.54421997  134.11235046 ...,  133.911026    133.53149414
    133.56251526]
  ..., 
  [ 125.93615723  123.7180481   122.78202057 ...,  122.90635681
    123.70700073  124.85311127]
  [ 126.33444214  124.57537842  124.16342163 ...,  124.21677399
    124.58626556  125.2334671 ]
  [ 126.88006592  125.61162567  125.71002197 ...,  125.62957764
    125.58708954  125.78111267]]

 [[ 132.65222168  131.95399475  132.68612671 ...,  132.45677185
    132.01864624  131.88241577]
  [ 131.43655396  130.53173828  131.14550781 ...,  130.88945007
    130.49732971  130.43733215]
  [ 130.32037354  129.07221985  129.54130554 ...,  129.29862976  129.090271
    129.24560547]
  ..., 
  [ 114.11546326  111.76417542  110.72415924 ...,  110.80375671
    111.73806763  113.11313629]
  [ 114.61319733  112.69290924  112.15375519 ...,  112.15737915
    112.67688751  113.55722046]
  [ 115.37586975  113.93477631  113.90866852 ...,  113.77098083
    113.88381958  114.31684113]]]
Train shape: (45000, 3, 32, 32) Test shape: (5000, 3, 32, 32)
Train y shape: (45000,) Test y shape: (5000,)
155.043 -140.353 -1.40867e-06
Error allocating 33554432 bytes of device memory (out of memory). Driver report 9318400 bytes free and 5032706048 bytes total 
Traceback (most recent call last):
  File "train_nn.py", line 110, in <module>
    train_loss = batch_iterator_train_crop_flip(train_X, train_y, BATCHSIZE, train_fn)
  File "/gwork/rqiao/R-D/cifar10/utils.py", line 123, in batch_iterator_train_crop_flip
    loss.append(train_fn(X_batch_aug, y_batch))
  File "/home/rqiao/Theano/theano/compile/function_module.py", line 875, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "/home/rqiao/Theano/theano/gof/link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "/home/rqiao/Theano/theano/compile/function_module.py", line 862, in __call__
    self.fn() if output_subset is None else\
MemoryError: Error allocating 33554432 bytes of device memory (out of memory).
Apply node that caused the error: GpuElemwise{sub,no_inplace}(GpuDnnConv{algo='small', inplace=True}.0, GpuDimShuffle{x,0,x,x}.0)
Toposort index: 920
Inputs types: [CudaNdarrayType(float32, 4D), CudaNdarrayType(float32, (True, False, True, True))]
Inputs shapes: [(64, 128, 32, 32), (1, 128, 1, 1)]
Inputs strides: [(131072, 1024, 32, 1), (0, 1, 0, 0)]
Inputs values: ['not shown', 'not shown']
Outputs clients: [[GpuElemwise{Composite{((i0 * i1) + i2)},no_inplace}(GpuElemwise{sub,no_inplace}.0, GpuElemwise{mul,no_inplace}.0, GpuDimShuffle{x,0,x,x}.0), GpuElemwise{Composite{((i0 * i1 * i2 * i3) + (i0 * i1 * i2 * i4 * i3))},no_inplace}(CudaNdarrayConstant{[[[[ 0.71428573]]]]}, GpuDnnConvGradI{algo='none', inplace=True}.0, GpuElemwise{Composite{Cast{float32}(LT(i0, i1))}}[(0, 0)].0, GpuElemwise{sub,no_inplace}.0, GpuElemwise{sgn,no_inplace}.0)]]

HINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.
HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.
Using gpu device 0: Tesla K20m (CNMeM is disabled, cuDNN 4007)
Using wide ResNet with depth 3 and width 8.
[[[ 130.74008179  130.15415955  131.04975891 ...,  131.09669495
    130.44146729  130.19473267]
  [ 130.17599487  129.3775177   130.23228455 ...,  130.09190369
    129.39170837  129.21621704]
  [ 129.84413147  128.80097961  129.55828857 ...,  129.24119568
    128.6313324   128.6625824 ]
  ..., 
  [ 126.55351257  124.59082031  123.90059662 ...,  124.31500244
    124.78046417  125.6194458 ]
  [ 127.07489014  125.45537567  125.24293518 ...,  125.56993103
    125.66368866  126.07813263]
  [ 127.70193481  126.57119751  126.82242584 ...,  126.82691193
    126.65567017  126.73181915]]

 [[ 136.09622192  135.46868896  136.25263977 ...,  136.33683777
    135.7567749   135.50079346]
  [ 135.39884949  134.52420044  135.2172699  ...,  135.16900635
    134.60858154  134.44306946]
  [ 134.7980957   133.62217712  134.16859436 ...,  133.95835876
    133.56106567  133.61766052]
  ..., 
  [ 125.97509003  123.75206757  122.79148865 ...,  123.12073517
    123.8923111   125.02235413]
  [ 126.42150879  124.60424805  124.17342377 ...,  124.47766876
    124.80351257  125.43726349]
  [ 126.95729065  125.66755676  125.75115204 ...,  125.81473541
    125.78250885  126.00793457]]

 [[ 132.58905029  131.87780762  132.58050537 ...,  132.47575378
    132.05458069  131.92146301]
  [ 131.45924377  130.52420044  131.13575745 ...,  130.94259644
    130.56588745  130.5275116 ]
  [ 130.3896637   129.13887024  129.59182739 ...,  129.32061768
    129.11549377  129.31982422]
  ..., 
  [ 114.18691254  111.81724548  110.75151062 ...,  110.99028778
    111.90233612  113.26773071]
  [ 114.71508789  112.73504639  112.1775589  ...,  112.38581848
    112.86477661  113.74809265]
  [ 115.48193359  114.00793457  113.95488739 ...,  113.94373322
    114.0577774   114.52098083]]]
Train shape: (45000, 3, 32, 32) Test shape: (5000, 3, 32, 32)
Train y shape: (45000,) Test y shape: (5000,)
154.935 -140.315 2.3316e-06
iter: 0 | TL: 4.158 | VL: 1.878 | Vacc: 0.39 | Ratio: 2.21 | Time: 1144.5
iter: 1 | TL: 3.663 | VL: 1.463 | Vacc: 0.573 | Ratio: 2.5 | Time: 1144.0
iter: 2 | TL: 3.406 | VL: 1.323 | Vacc: 0.608 | Ratio: 2.57 | Time: 1143.9
iter: 3 | TL: 3.215 | VL: 1.343 | Vacc: 0.631 | Ratio: 2.39 | Time: 1143.9
iter: 4 | TL: 3.057 | VL: 1.194 | Vacc: 0.65 | Ratio: 2.56 | Time: 1144.0
iter: 5 | TL: 2.918 | VL: 0.729 | Vacc: 0.761 | Ratio: 4.0 | Time: 1144.1
iter: 6 | TL: 2.797 | VL: 0.702 | Vacc: 0.777 | Ratio: 3.99 | Time: 1143.9
iter: 7 | TL: 2.694 | VL: 0.731 | Vacc: 0.776 | Ratio: 3.69 | Time: 1144.0
iter: 8 | TL: 2.592 | VL: 0.555 | Vacc: 0.825 | Ratio: 4.67 | Time: 1144.1
iter: 9 | TL: 2.507 | VL: 0.518 | Vacc: 0.83 | Ratio: 4.84 | Time: 1144.0
iter: 10 | TL: 2.646 | VL: 0.947 | Vacc: 0.708 | Ratio: 2.79 | Time: 1144.0
iter: 11 | TL: 2.078 | VL: 0.666 | Vacc: 0.784 | Ratio: 3.12 | Time: 1144.0
iter: 12 | TL: 1.731 | VL: 0.778 | Vacc: 0.756 | Ratio: 2.23 | Time: 1144.0
iter: 13 | TL: 1.473 | VL: 0.808 | Vacc: 0.747 | Ratio: 1.82 | Time: 1144.0
iter: 14 | TL: 1.291 | VL: 0.57 | Vacc: 0.814 | Ratio: 2.27 | Time: 1144.0
iter: 15 | TL: 1.154 | VL: 0.591 | Vacc: 0.8 | Ratio: 1.95 | Time: 1144.0
iter: 16 | TL: 1.048 | VL: 0.593 | Vacc: 0.808 | Ratio: 1.77 | Time: 1144.1
iter: 17 | TL: 0.979 | VL: 0.629 | Vacc: 0.806 | Ratio: 1.56 | Time: 1144.1
iter: 18 | TL: 0.929 | VL: 0.619 | Vacc: 0.804 | Ratio: 1.5 | Time: 1144.0
iter: 19 | TL: 0.889 | VL: 0.543 | Vacc: 0.824 | Ratio: 1.64 | Time: 1144.0
iter: 20 | TL: 0.861 | VL: 0.469 | Vacc: 0.841 | Ratio: 1.83 | Time: 1143.9
iter: 21 | TL: 0.852 | VL: 0.686 | Vacc: 0.793 | Ratio: 1.24 | Time: 1144.1
iter: 22 | TL: 0.848 | VL: 0.664 | Vacc: 0.801 | Ratio: 1.28 | Time: 1144.2
iter: 23 | TL: 0.833 | VL: 0.438 | Vacc: 0.86 | Ratio: 1.9 | Time: 1144.1
iter: 24 | TL: 0.812 | VL: 0.505 | Vacc: 0.83 | Ratio: 1.61 | Time: 1144.1
iter: 25 | TL: 0.806 | VL: 0.534 | Vacc: 0.84 | Ratio: 1.51 | Time: 1144.1
iter: 26 | TL: 0.806 | VL: 0.522 | Vacc: 0.84 | Ratio: 1.54 | Time: 1143.9
iter: 27 | TL: 0.815 | VL: 0.439 | Vacc: 0.858 | Ratio: 1.85 | Time: 1144.0
iter: 28 | TL: 0.806 | VL: 0.507 | Vacc: 0.843 | Ratio: 1.59 | Time: 1144.0
iter: 29 | TL: 0.803 | VL: 0.485 | Vacc: 0.848 | Ratio: 1.66 | Time: 1144.0
iter: 30 | TL: 0.799 | VL: 0.501 | Vacc: 0.851 | Ratio: 1.6 | Time: 1143.9
iter: 31 | TL: 0.795 | VL: 0.391 | Vacc: 0.869 | Ratio: 2.03 | Time: 1164.4
iter: 32 | TL: 0.793 | VL: 0.542 | Vacc: 0.827 | Ratio: 1.46 | Time: 1173.8
iter: 33 | TL: 0.796 | VL: 0.424 | Vacc: 0.857 | Ratio: 1.88 | Time: 1169.3
iter: 34 | TL: 0.8 | VL: 0.587 | Vacc: 0.82 | Ratio: 1.36 | Time: 1144.3
iter: 35 | TL: 0.805 | VL: 0.499 | Vacc: 0.852 | Ratio: 1.61 | Time: 1144.0
iter: 36 | TL: 0.804 | VL: 0.496 | Vacc: 0.839 | Ratio: 1.62 | Time: 1144.0
iter: 37 | TL: 0.797 | VL: 0.508 | Vacc: 0.848 | Ratio: 1.57 | Time: 1144.1
iter: 38 | TL: 0.801 | VL: 0.508 | Vacc: 0.841 | Ratio: 1.58 | Time: 1144.0
iter: 39 | TL: 0.802 | VL: 0.482 | Vacc: 0.849 | Ratio: 1.66 | Time: 1144.0
iter: 40 | TL: 0.81 | VL: 0.402 | Vacc: 0.87 | Ratio: 2.02 | Time: 1144.0
iter: 41 | TL: 0.808 | VL: 0.56 | Vacc: 0.827 | Ratio: 1.44 | Time: 1144.0
iter: 42 | TL: 0.812 | VL: 0.365 | Vacc: 0.882 | Ratio: 2.22 | Time: 1144.0
iter: 43 | TL: 0.806 | VL: 0.522 | Vacc: 0.837 | Ratio: 1.55 | Time: 1144.0
iter: 44 | TL: 0.797 | VL: 0.682 | Vacc: 0.8 | Ratio: 1.17 | Time: 1144.0
iter: 45 | TL: 0.807 | VL: 0.457 | Vacc: 0.851 | Ratio: 1.77 | Time: 1144.0
iter: 46 | TL: 0.815 | VL: 0.459 | Vacc: 0.849 | Ratio: 1.77 | Time: 1144.0
iter: 47 | TL: 0.814 | VL: 0.461 | Vacc: 0.86 | Ratio: 1.77 | Time: 1144.2
iter: 48 | TL: 0.809 | VL: 0.417 | Vacc: 0.866 | Ratio: 1.94 | Time: 1144.0
iter: 49 | TL: 0.803 | VL: 0.496 | Vacc: 0.849 | Ratio: 1.62 | Time: 1144.1
iter: 50 | TL: 0.809 | VL: 0.406 | Vacc: 0.872 | Ratio: 1.99 | Time: 1144.0
iter: 51 | TL: 0.805 | VL: 0.48 | Vacc: 0.851 | Ratio: 1.68 | Time: 1144.0
iter: 52 | TL: 0.806 | VL: 0.403 | Vacc: 0.871 | Ratio: 2.0 | Time: 1144.1
iter: 53 | TL: 0.806 | VL: 0.465 | Vacc: 0.85 | Ratio: 1.73 | Time: 1144.1
iter: 54 | TL: 0.818 | VL: 0.673 | Vacc: 0.812 | Ratio: 1.22 | Time: 1144.0
iter: 55 | TL: 0.819 | VL: 1.056 | Vacc: 0.743 | Ratio: 0.78 | Time: 1144.0
iter: 56 | TL: 0.827 | VL: 0.469 | Vacc: 0.859 | Ratio: 1.76 | Time: 1144.0
iter: 57 | TL: 0.811 | VL: 0.513 | Vacc: 0.853 | Ratio: 1.58 | Time: 1144.0
iter: 58 | TL: 0.814 | VL: 0.613 | Vacc: 0.815 | Ratio: 1.33 | Time: 1144.0
iter: 59 | TL: 0.824 | VL: 0.382 | Vacc: 0.877 | Ratio: 2.16 | Time: 1144.0
iter: 60 | TL: 0.815 | VL: 0.911 | Vacc: 0.765 | Ratio: 0.89 | Time: 1144.0
iter: 61 | TL: 0.83 | VL: 1.175 | Vacc: 0.715 | Ratio: 0.71 | Time: 1144.0
iter: 62 | TL: 0.832 | VL: 0.44 | Vacc: 0.866 | Ratio: 1.89 | Time: 1144.1
iter: 63 | TL: 0.814 | VL: 0.376 | Vacc: 0.88 | Ratio: 2.16 | Time: 1144.1
iter: 64 | TL: 0.821 | VL: 0.405 | Vacc: 0.866 | Ratio: 2.03 | Time: 1144.1
iter: 65 | TL: 0.816 | VL: 0.49 | Vacc: 0.85 | Ratio: 1.67 | Time: 1144.2
iter: 66 | TL: 0.805 | VL: 0.377 | Vacc: 0.878 | Ratio: 2.14 | Time: 1144.3
iter: 67 | TL: 0.814 | VL: 0.513 | Vacc: 0.843 | Ratio: 1.59 | Time: 1144.2
iter: 68 | TL: 0.818 | VL: 1.578 | Vacc: 0.676 | Ratio: 0.52 | Time: 1144.0
iter: 69 | TL: 0.827 | VL: 0.447 | Vacc: 0.862 | Ratio: 1.85 | Time: 1144.1
iter: 70 | TL: 0.827 | VL: 0.674 | Vacc: 0.812 | Ratio: 1.23 | Time: 1144.1
iter: 71 | TL: 0.833 | VL: 0.44 | Vacc: 0.861 | Ratio: 1.89 | Time: 1144.1
iter: 72 | TL: 0.822 | VL: 0.462 | Vacc: 0.856 | Ratio: 1.78 | Time: 1144.2
iter: 73 | TL: 0.815 | VL: 0.419 | Vacc: 0.866 | Ratio: 1.94 | Time: 1144.0
iter: 74 | TL: 0.814 | VL: 0.459 | Vacc: 0.862 | Ratio: 1.77 | Time: 1164.9
iter: 75 | TL: 0.817 | VL: 0.427 | Vacc: 0.865 | Ratio: 1.91 | Time: 1173.8
iter: 76 | TL: 0.813 | VL: 0.364 | Vacc: 0.878 | Ratio: 2.24 | Time: 1170.7
iter: 77 | TL: 0.813 | VL: 0.44 | Vacc: 0.863 | Ratio: 1.85 | Time: 1153.5
iter: 78 | TL: 0.817 | VL: 0.455 | Vacc: 0.869 | Ratio: 1.79 | Time: 1153.4
iter: 79 | TL: 0.822 | VL: 0.449 | Vacc: 0.862 | Ratio: 1.83 | Time: 1144.2
iter: 80 | TL: 0.699 | VL: 0.187 | Vacc: 0.942 | Ratio: 3.73 | Time: 1144.2
iter: 81 | TL: 0.626 | VL: 0.175 | Vacc: 0.946 | Ratio: 3.58 | Time: 1144.2
iter: 82 | TL: 0.593 | VL: 0.167 | Vacc: 0.951 | Ratio: 3.54 | Time: 1144.2
iter: 83 | TL: 0.569 | VL: 0.181 | Vacc: 0.945 | Ratio: 3.14 | Time: 1144.1
iter: 84 | TL: 0.549 | VL: 0.174 | Vacc: 0.948 | Ratio: 3.15 | Time: 1144.1
iter: 85 | TL: 0.532 | VL: 0.172 | Vacc: 0.949 | Ratio: 3.09 | Time: 1144.2
iter: 86 | TL: 0.515 | VL: 0.176 | Vacc: 0.95 | Ratio: 2.93 | Time: 1144.3
iter: 87 | TL: 0.501 | VL: 0.182 | Vacc: 0.946 | Ratio: 2.76 | Time: 1144.2
iter: 88 | TL: 0.485 | VL: 0.179 | Vacc: 0.949 | Ratio: 2.71 | Time: 1144.2
iter: 89 | TL: 0.47 | VL: 0.181 | Vacc: 0.948 | Ratio: 2.6 | Time: 1144.1
iter: 90 | TL: 0.457 | VL: 0.187 | Vacc: 0.948 | Ratio: 2.45 | Time: 1144.2
iter: 91 | TL: 0.447 | VL: 0.195 | Vacc: 0.948 | Ratio: 2.29 | Time: 1144.1
iter: 92 | TL: 0.434 | VL: 0.183 | Vacc: 0.95 | Ratio: 2.37 | Time: 1144.1
iter: 93 | TL: 0.421 | VL: 0.196 | Vacc: 0.949 | Ratio: 2.15 | Time: 1144.3
iter: 94 | TL: 0.411 | VL: 0.193 | Vacc: 0.951 | Ratio: 2.14 | Time: 1144.1
iter: 95 | TL: 0.399 | VL: 0.199 | Vacc: 0.951 | Ratio: 2.01 | Time: 1144.2
iter: 96 | TL: 0.394 | VL: 0.2 | Vacc: 0.947 | Ratio: 1.96 | Time: 1144.2
iter: 97 | TL: 0.385 | VL: 0.21 | Vacc: 0.947 | Ratio: 1.83 | Time: 1144.3
iter: 98 | TL: 0.373 | VL: 0.228 | Vacc: 0.945 | Ratio: 1.63 | Time: 1144.2
iter: 99 | TL: 0.365 | VL: 0.212 | Vacc: 0.946 | Ratio: 1.72 | Time: 1144.2
iter: 100 | TL: 0.36 | VL: 0.198 | Vacc: 0.949 | Ratio: 1.82 | Time: 1144.1
iter: 101 | TL: 0.351 | VL: 0.204 | Vacc: 0.949 | Ratio: 1.72 | Time: 1144.1
iter: 102 | TL: 0.342 | VL: 0.215 | Vacc: 0.945 | Ratio: 1.59 | Time: 1144.1
iter: 103 | TL: 0.336 | VL: 0.219 | Vacc: 0.948 | Ratio: 1.54 | Time: 1144.4
iter: 104 | TL: 0.332 | VL: 0.211 | Vacc: 0.948 | Ratio: 1.58 | Time: 1144.2
iter: 105 | TL: 0.323 | VL: 0.21 | Vacc: 0.948 | Ratio: 1.54 | Time: 1144.1
iter: 106 | TL: 0.317 | VL: 0.211 | Vacc: 0.946 | Ratio: 1.5 | Time: 1144.3
iter: 107 | TL: 0.311 | VL: 0.199 | Vacc: 0.95 | Ratio: 1.56 | Time: 1144.0
iter: 108 | TL: 0.308 | VL: 0.238 | Vacc: 0.942 | Ratio: 1.29 | Time: 1144.0
iter: 109 | TL: 0.306 | VL: 0.213 | Vacc: 0.944 | Ratio: 1.43 | Time: 1144.1
iter: 110 | TL: 0.295 | VL: 0.209 | Vacc: 0.947 | Ratio: 1.41 | Time: 1144.1
iter: 111 | TL: 0.293 | VL: 0.213 | Vacc: 0.945 | Ratio: 1.38 | Time: 1144.1
iter: 112 | TL: 0.284 | VL: 0.213 | Vacc: 0.947 | Ratio: 1.34 | Time: 1144.1
iter: 113 | TL: 0.284 | VL: 0.216 | Vacc: 0.947 | Ratio: 1.31 | Time: 1144.1
iter: 114 | TL: 0.277 | VL: 0.218 | Vacc: 0.949 | Ratio: 1.27 | Time: 1144.1
iter: 115 | TL: 0.273 | VL: 0.208 | Vacc: 0.947 | Ratio: 1.32 | Time: 1144.2
iter: 116 | TL: 0.271 | VL: 0.218 | Vacc: 0.944 | Ratio: 1.24 | Time: 1144.1
iter: 117 | TL: 0.267 | VL: 0.219 | Vacc: 0.947 | Ratio: 1.22 | Time: 1144.1
iter: 118 | TL: 0.264 | VL: 0.227 | Vacc: 0.944 | Ratio: 1.17 | Time: 1144.1
iter: 119 | TL: 0.262 | VL: 0.226 | Vacc: 0.948 | Ratio: 1.16 | Time: 1144.1
iter: 120 | TL: 0.251 | VL: 0.194 | Vacc: 0.952 | Ratio: 1.29 | Time: 1144.1
iter: 121 | TL: 0.246 | VL: 0.2 | Vacc: 0.949 | Ratio: 1.23 | Time: 1144.1
iter: 122 | TL: 0.244 | VL: 0.196 | Vacc: 0.953 | Ratio: 1.24 | Time: 1144.2
iter: 123 | TL: 0.241 | VL: 0.193 | Vacc: 0.955 | Ratio: 1.25 | Time: 1144.1
iter: 124 | TL: 0.24 | VL: 0.191 | Vacc: 0.955 | Ratio: 1.25 | Time: 1144.2
iter: 125 | TL: 0.238 | VL: 0.193 | Vacc: 0.954 | Ratio: 1.23 | Time: 1144.2
iter: 126 | TL: 0.237 | VL: 0.189 | Vacc: 0.956 | Ratio: 1.26 | Time: 1144.2
iter: 127 | TL: 0.236 | VL: 0.189 | Vacc: 0.956 | Ratio: 1.25 | Time: 1144.1
iter: 128 | TL: 0.235 | VL: 0.192 | Vacc: 0.956 | Ratio: 1.23 | Time: 1144.1
iter: 129 | TL: 0.234 | VL: 0.195 | Vacc: 0.956 | Ratio: 1.2 | Time: 1144.2
iter: 130 | TL: 0.234 | VL: 0.192 | Vacc: 0.954 | Ratio: 1.21 | Time: 1144.1
iter: 131 | TL: 0.232 | VL: 0.193 | Vacc: 0.956 | Ratio: 1.2 | Time: 1144.2
iter: 132 | TL: 0.232 | VL: 0.187 | Vacc: 0.956 | Ratio: 1.24 | Time: 1144.2
iter: 133 | TL: 0.231 | VL: 0.196 | Vacc: 0.956 | Ratio: 1.18 | Time: 1144.1
iter: 134 | TL: 0.231 | VL: 0.191 | Vacc: 0.955 | Ratio: 1.21 | Time: 1144.1
iter: 135 | TL: 0.23 | VL: 0.195 | Vacc: 0.955 | Ratio: 1.18 | Time: 1144.1
iter: 136 | TL: 0.229 | VL: 0.191 | Vacc: 0.956 | Ratio: 1.2 | Time: 1144.1
iter: 137 | TL: 0.229 | VL: 0.196 | Vacc: 0.955 | Ratio: 1.17 | Time: 1144.3
iter: 138 | TL: 0.227 | VL: 0.193 | Vacc: 0.956 | Ratio: 1.18 | Time: 1144.1
iter: 139 | TL: 0.227 | VL: 0.2 | Vacc: 0.955 | Ratio: 1.13 | Time: 1144.3
iter: 140 | TL: 0.226 | VL: 0.196 | Vacc: 0.956 | Ratio: 1.16 | Time: 1144.2
iter: 141 | TL: 0.226 | VL: 0.197 | Vacc: 0.955 | Ratio: 1.15 | Time: 1144.2
iter: 142 | TL: 0.224 | VL: 0.202 | Vacc: 0.956 | Ratio: 1.11 | Time: 1144.2
iter: 143 | TL: 0.224 | VL: 0.194 | Vacc: 0.955 | Ratio: 1.16 | Time: 1144.1
iter: 144 | TL: 0.223 | VL: 0.195 | Vacc: 0.955 | Ratio: 1.14 | Time: 1144.1
iter: 145 | TL: 0.223 | VL: 0.194 | Vacc: 0.957 | Ratio: 1.15 | Time: 1144.1
iter: 146 | TL: 0.222 | VL: 0.194 | Vacc: 0.957 | Ratio: 1.14 | Time: 1144.1
iter: 147 | TL: 0.221 | VL: 0.192 | Vacc: 0.956 | Ratio: 1.16 | Time: 1144.2
iter: 148 | TL: 0.221 | VL: 0.193 | Vacc: 0.957 | Ratio: 1.14 | Time: 1144.2
iter: 149 | TL: 0.22 | VL: 0.191 | Vacc: 0.957 | Ratio: 1.15 | Time: 1144.2
iter: 150 | TL: 0.22 | VL: 0.195 | Vacc: 0.957 | Ratio: 1.13 | Time: 1150.7
iter: 151 | TL: 0.219 | VL: 0.197 | Vacc: 0.955 | Ratio: 1.11 | Time: 1154.0
iter: 152 | TL: 0.218 | VL: 0.191 | Vacc: 0.956 | Ratio: 1.14 | Time: 1165.7
iter: 153 | TL: 0.218 | VL: 0.196 | Vacc: 0.955 | Ratio: 1.11 | Time: 1158.2
iter: 154 | TL: 0.217 | VL: 0.189 | Vacc: 0.957 | Ratio: 1.15 | Time: 1144.2
iter: 155 | TL: 0.216 | VL: 0.191 | Vacc: 0.959 | Ratio: 1.13 | Time: 1144.1
iter: 156 | TL: 0.216 | VL: 0.199 | Vacc: 0.956 | Ratio: 1.08 | Time: 1144.2
iter: 157 | TL: 0.215 | VL: 0.2 | Vacc: 0.956 | Ratio: 1.08 | Time: 1144.1
iter: 158 | TL: 0.215 | VL: 0.189 | Vacc: 0.957 | Ratio: 1.14 | Time: 1144.2
iter: 159 | TL: 0.214 | VL: 0.193 | Vacc: 0.956 | Ratio: 1.11 | Time: 1144.2
iter: 160 | TL: 0.213 | VL: 0.198 | Vacc: 0.956 | Ratio: 1.08 | Time: 1144.1
iter: 161 | TL: 0.213 | VL: 0.2 | Vacc: 0.956 | Ratio: 1.06 | Time: 1144.2
iter: 162 | TL: 0.212 | VL: 0.197 | Vacc: 0.956 | Ratio: 1.08 | Time: 1144.2
iter: 163 | TL: 0.212 | VL: 0.199 | Vacc: 0.954 | Ratio: 1.07 | Time: 1144.4
iter: 164 | TL: 0.211 | VL: 0.199 | Vacc: 0.956 | Ratio: 1.06 | Time: 1144.2
iter: 165 | TL: 0.211 | VL: 0.206 | Vacc: 0.954 | Ratio: 1.02 | Time: 1144.3
iter: 166 | TL: 0.21 | VL: 0.198 | Vacc: 0.955 | Ratio: 1.06 | Time: 1144.2
iter: 167 | TL: 0.209 | VL: 0.198 | Vacc: 0.956 | Ratio: 1.05 | Time: 1144.1
iter: 168 | TL: 0.209 | VL: 0.198 | Vacc: 0.957 | Ratio: 1.06 | Time: 1144.2
iter: 169 | TL: 0.208 | VL: 0.2 | Vacc: 0.954 | Ratio: 1.04 | Time: 1144.3
iter: 170 | TL: 0.208 | VL: 0.197 | Vacc: 0.956 | Ratio: 1.05 | Time: 1144.3
iter: 171 | TL: 0.208 | VL: 0.192 | Vacc: 0.957 | Ratio: 1.08 | Time: 1144.2
iter: 172 | TL: 0.207 | VL: 0.196 | Vacc: 0.955 | Ratio: 1.06 | Time: 1144.2
iter: 173 | TL: 0.206 | VL: 0.196 | Vacc: 0.955 | Ratio: 1.05 | Time: 1144.2
iter: 174 | TL: 0.206 | VL: 0.196 | Vacc: 0.956 | Ratio: 1.05 | Time: 1144.2
iter: 175 | TL: 0.205 | VL: 0.192 | Vacc: 0.956 | Ratio: 1.07 | Time: 1144.2
iter: 176 | TL: 0.205 | VL: 0.193 | Vacc: 0.955 | Ratio: 1.06 | Time: 1144.2
iter: 177 | TL: 0.204 | VL: 0.191 | Vacc: 0.957 | Ratio: 1.07 | Time: 1144.2
iter: 178 | TL: 0.203 | VL: 0.196 | Vacc: 0.958 | Ratio: 1.03 | Time: 1144.2
iter: 179 | TL: 0.203 | VL: 0.187 | Vacc: 0.957 | Ratio: 1.08 | Time: 1144.2
iter: 180 | TL: 0.203 | VL: 0.195 | Vacc: 0.956 | Ratio: 1.04 | Time: 1144.3
iter: 181 | TL: 0.202 | VL: 0.193 | Vacc: 0.957 | Ratio: 1.05 | Time: 1144.2
iter: 182 | TL: 0.202 | VL: 0.195 | Vacc: 0.955 | Ratio: 1.03 | Time: 1144.1
iter: 183 | TL: 0.201 | VL: 0.197 | Vacc: 0.955 | Ratio: 1.02 | Time: 1144.2
iter: 184 | TL: 0.2 | VL: 0.193 | Vacc: 0.955 | Ratio: 1.04 | Time: 1144.1
iter: 185 | TL: 0.2 | VL: 0.2 | Vacc: 0.955 | Ratio: 1.0 | Time: 1144.3
iter: 186 | TL: 0.199 | VL: 0.196 | Vacc: 0.954 | Ratio: 1.02 | Time: 1144.3
iter: 187 | TL: 0.199 | VL: 0.195 | Vacc: 0.955 | Ratio: 1.02 | Time: 1144.3
iter: 188 | TL: 0.198 | VL: 0.207 | Vacc: 0.955 | Ratio: 0.96 | Time: 1144.2
iter: 189 | TL: 0.198 | VL: 0.194 | Vacc: 0.956 | Ratio: 1.02 | Time: 1144.2
iter: 190 | TL: 0.197 | VL: 0.197 | Vacc: 0.956 | Ratio: 1.0 | Time: 1144.2
iter: 191 | TL: 0.196 | VL: 0.191 | Vacc: 0.956 | Ratio: 1.03 | Time: 1144.2
iter: 192 | TL: 0.196 | VL: 0.199 | Vacc: 0.955 | Ratio: 0.99 | Time: 1144.2
iter: 193 | TL: 0.195 | VL: 0.203 | Vacc: 0.955 | Ratio: 0.96 | Time: 1144.2
iter: 194 | TL: 0.195 | VL: 0.199 | Vacc: 0.956 | Ratio: 0.98 | Time: 1144.2
iter: 195 | TL: 0.195 | VL: 0.198 | Vacc: 0.956 | Ratio: 0.98 | Time: 1144.3
iter: 196 | TL: 0.194 | VL: 0.2 | Vacc: 0.957 | Ratio: 0.97 | Time: 1144.2
iter: 197 | TL: 0.193 | VL: 0.201 | Vacc: 0.956 | Ratio: 0.96 | Time: 1144.2
iter: 198 | TL: 0.193 | VL: 0.198 | Vacc: 0.956 | Ratio: 0.98 | Time: 1144.2
iter: 199 | TL: 0.192 | VL: 0.196 | Vacc: 0.956 | Ratio: 0.98 | Time: 1144.2
Final Acc: 0.958663
Traceback (most recent call last):
  File "train_nn.py", line 140, in <module>
    pyplot.plot(train_eval, label='Train loss', color='#707070')
  File "/opt/sharcnet/python/2.7.5/gcc/lib/python2.7/site-packages/matplotlib-1.3.0-py2.7-linux-x86_64.egg/matplotlib/pyplot.py", line 2980, in plot
    ax = gca()
  File "/opt/sharcnet/python/2.7.5/gcc/lib/python2.7/site-packages/matplotlib-1.3.0-py2.7-linux-x86_64.egg/matplotlib/pyplot.py", line 803, in gca
    ax =  gcf().gca(**kwargs)
  File "/opt/sharcnet/python/2.7.5/gcc/lib/python2.7/site-packages/matplotlib-1.3.0-py2.7-linux-x86_64.egg/matplotlib/pyplot.py", line 450, in gcf
    return figure()
  File "/opt/sharcnet/python/2.7.5/gcc/lib/python2.7/site-packages/matplotlib-1.3.0-py2.7-linux-x86_64.egg/matplotlib/pyplot.py", line 423, in figure
    **kwargs)
  File "/opt/sharcnet/python/2.7.5/gcc/lib/python2.7/site-packages/matplotlib-1.3.0-py2.7-linux-x86_64.egg/matplotlib/backends/backend_tkagg.py", line 79, in new_figure_manager
    return new_figure_manager_given_figure(num, figure)
  File "/opt/sharcnet/python/2.7.5/gcc/lib/python2.7/site-packages/matplotlib-1.3.0-py2.7-linux-x86_64.egg/matplotlib/backends/backend_tkagg.py", line 87, in new_figure_manager_given_figure
    window = Tk.Tk()
  File "/opt/sharcnet/python/2.7.5/gcc/lib/python2.7/lib-tk/Tkinter.py", line 1745, in __init__
    self.tk = _tkinter.create(screenName, baseName, className, interactive, wantobjects, useTk, sync, use)
_tkinter.TclError: no display name and no $DISPLAY environment variable
